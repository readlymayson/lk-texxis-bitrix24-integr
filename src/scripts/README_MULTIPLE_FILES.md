# Тестирование множественных файлов в equipment_list

## Обзор

Скрипт `test_project_creation.php` теперь поддерживает прикрепление нескольких файлов к полю `equipment_list` при создании проекта.

## Использование

### 1. Создание проекта с одним файлом (автоматическая загрузка)

```bash
php test_project_creation.php 3
```

Будет использован тестовый файл `test_equipment_list.txt` из директории скрипта.

### 2. Создание проекта с несколькими существующими файлами по ID

```bash
php test_project_creation.php 3 123 456 789
```

Прикрепит к проекту файлы с ID 123, 456 и 789 из Bitrix24.

### 3. Создание проекта с загрузкой нескольких новых файлов

```bash
php test_project_creation.php 3 --files test_equipment_list.txt test_equipment_list_2.txt test_equipment_list_3.txt
```

Загрузит указанные файлы в Bitrix24 и прикрепит их к проекту.

### 4. Комбинированный вариант (существующие + новые файлы)

Сначала загрузите файлы и получите их ID, затем используйте их:

```bash
# Загружаем файлы отдельно и получаем ID
# Затем используем ID
php test_project_creation.php 3 123 456 --files test_equipment_list_3.txt
```

## Доступные тестовые файлы

В директории `src/scripts/` доступны следующие тестовые файлы:

- `test_equipment_list.txt` - основной тестовый файл (используется по умолчанию)
- `test_equipment_list_2.txt` - дополнительный тестовый файл
- `test_equipment_list_3.txt` - дополнительный тестовый файл

## Примеры команд

### Пример 1: Тест с 3 файлами
```bash
cd /var/www/efrolov-dev/html/application/lk/src/scripts
php test_project_creation.php 3 --files test_equipment_list.txt test_equipment_list_2.txt test_equipment_list_3.txt
```

### Пример 2: Тест с существующими файлами
```bash
# Предположим, что файлы уже загружены в Bitrix24 с ID 100, 101, 102
php test_project_creation.php 3 100 101 102
```

### Пример 3: Интерактивный режим
```bash
php test_project_creation.php
# Скрипт попросит ввести Contact ID
```

## Проверка результата

После выполнения скрипта:

1. Проверьте вывод скрипта - должно быть сообщение об успешном создании проекта
2. Проверьте логи в файле: `src/logs/bitrix24_webhooks.log`
3. Проверьте созданный проект в Bitrix24 - поле "Перечень оборудования" должно содержать все прикрепленные файлы
4. Проверьте отображение в личном кабинете - все файлы должны отображаться в таблице проектов

## Примечания

- Если файл не найден по указанному пути, скрипт выведет предупреждение и пропустит этот файл
- Если не указаны ни file_id, ни --files, будет использован тестовый файл `test_equipment_list.txt`
- Все файлы должны существовать и быть доступны для чтения
- Убедитесь, что у webhook есть права на загрузку файлов (disk) в Bitrix24

