#!/bin/bash

# Скрипт для запуска локального веб-сервера

echo "=========================================="
echo "Запуск веб-сервера для интеграции Битрикс24"
echo "=========================================="

# Проверка наличия PHP
if ! command -v php &> /dev/null; then
    echo "Ошибка: PHP не найден!"
    echo "Установите PHP 7.4+ для работы интеграции"
    exit 1
fi

# Создание необходимых директорий
mkdir -p src/logs
mkdir -p tests

# Установка прав доступа
chmod 755 src/webhooks/bitrix24.php 2>/dev/null || true

echo "Запуск сервера на http://0.0.0.0:8000"
echo "Доступ из локальной сети: http://$(hostname -I | awk '{print $1}'):8000"
echo "Для остановки нажмите Ctrl+C"
echo ""

# Запуск встроенного сервера PHP (доступен из сети)
php -S 0.0.0.0:8000

echo ""
echo "Сервер остановлен"
